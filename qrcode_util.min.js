/*
 生成带logo二维码工具类QRcodeUtil
 依赖qrcode.js、html2canvas.js
 QRcodeUtil.makeCode({
        logo: document.getElementById('logo'), // logo元素(可选)
        logoBgShow: true, // 是否显示logo背景 (可选)
        url: 'http://www.baidu.com', // 二维码url
        target: document.body, // 显示二维码的目标元素
        width: 400, // 二维码宽度(px) (可选)
        height: 400, // 二维码高度(px) (可选)
        borderWidth: 20 // 二维码边框宽度 (可选)
        borderColor: '#fff' // 二维码边框颜色 (可选)
    }).makeImage(); // 生成二维码图片(可选)
*/
!function(l){var h=l.document,k={},e;k.makeCode=function(b){e=h.createElement("div");e.style.position="relative";e.style.boxSizing="content-box";var c=b.width||160,d=b.height||160;if(100>b.width||100>b.height)alert("\u4e8c\u7ef4\u7801\u5bbd\u9ad8\u4e0d\u80fd\u5c0f\u4e8e100");else{var g=b.borderWidth||16;e.style.width=c+"px";e.style.height=d+"px";e.style.border=g+"px solid "+(b.borderColor||"#fff");(new QRCode(e,{width:c,height:d})).makeCode(b.url);if(b.logo){g=e.querySelector("canvas").cloneNode();
    g.width=2*c;g.height=2*d;g.style.width=c+"px";g.style.height=d+"px";var a=g.getContext("2d");a.scale(2,2);a.drawImage(b.logo,parseInt(.75*c/2),parseInt(.75*d/2),parseInt(.25*c),parseInt(.25*d));if(b.logoBgShow){a=h.createElement("div");a.style.position="absolute";a.style.height=parseInt(.25*d)-1+"px";a.style.width=parseInt(.25*c)+"px";a.style.border="1px solid #ccc";a.style.borderRadius="8px";a.style.top=parseInt((d-(.25*d+2))/2)+"px";a.style.left=parseInt((c-(.25*c+2))/2)+"px";a.style.zIndex="999";
        a.style.backgroundColor="#fff";var f=h.createElement("div");f.style.position="absolute";f.style.height=parseInt(.25*d+.04*d)+"px";f.style.width=parseInt(.25*c+.04*c)+"px";f.style.borderRadius="10px";f.style.top=parseInt((d-(.25*d+.04*d))/2)+"px";f.style.left=parseInt((c-(.25*c+.04*c))/2)+"px";f.style.zIndex="998";f.style.backgroundColor="#fff";e.insertAdjacentElement("beforeend",a);e.insertAdjacentElement("beforeend",f)}a=h.createElement("img");a.src=g.toDataURL("image/png");a.style.height=d+"px";
    a.style.width=c+"px";a.style.position="absolute";a.style.top="0";a.style.left="0";a.style.zIndex="1000";e.insertAdjacentElement("beforeend",a)}b.target.insertAdjacentElement("beforeend",e);return this}};k.makeImage=function(){var b=h.createElement("canvas"),c=e.offsetWidth,d=e.offsetHeight;b.width=4*c;b.height=4*d;b.style.width=c+"px";b.style.height=d+"px";b.getContext("2d").scale(4,4);html2canvas(e,{canvas:b,width:c,height:d,scale:4,logging:!1,useCORS:!0}).then(function(b){var a=new Image;a.width=
    c;a.height=d;a.onload=function(){e.innerHTML="";e.style.border="none";e.insertAdjacentElement("beforeend",this)};a.src=b.toDataURL()})};l.QRcodeUtil=k}(window);